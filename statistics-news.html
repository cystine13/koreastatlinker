<script>
    fetch("header.html")
        .then(response => response.text())
        .then(data => {
            document.getElementById("header").innerHTML = data;
        })
        .catch(error => console.error("Error loading header:", error));

    const jsonUrl = './news_posts.json';
    let newsData = [];

    fetch(jsonUrl)
        .then(response => {
            if (!response.ok) {
                throw new Error(`HTTP error! status: ${response.status}`);
            }
            return response.json();
        })
        .then(data => {
            newsData = data; // JSON 데이터 그대로 사용 (순서 유지)
            renderNews(newsData);
        })
        .catch(error => {
            console.error('Error loading JSON data:', error);
            document.getElementById('newsList').innerHTML = 
                `<tr><td colspan="3" style="color: red; text-align: center;">Failed to load news data. Please try again later.</td></tr>`;
        });

    function renderNews(newsItems) {
        const newsList = document.getElementById("newsList");
        newsList.innerHTML = "";

        newsItems.forEach(news => {  // JSON 순서대로 출력 (가장 최근 뉴스가 위쪽)
            const row = document.createElement("tr");
            row.innerHTML = `
                <td class="title-data"><a href="${news.link}" target="_blank">${news.title_en}</a></td>
                <td class="source-col">${news.source_en}</td>
                <td class="date-col">${news.date}</td>
            `;
            newsList.appendChild(row);
        });
    }

    document.getElementById("searchInput").addEventListener("input", function () {
        const query = this.value.toLowerCase();
        const filteredNews = newsData.filter(news =>
            news.title_en.toLowerCase().includes(query) ||
            news.source_en.toLowerCase().includes(query) ||
            news.date.includes(query)
        );
        renderNews(filteredNews);
    });
</script>
